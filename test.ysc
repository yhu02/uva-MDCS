always /
    var v : real = cmdSpeed;
    var w : real = cmdRot;

    // --- 1) Soft front safety: slow down when wall getting close ---
    v = (v > 0.0) ? ((laserDistance.dFrontMin < 0.3) ? v * 0.5 : v) : v;

    // --- 2) Corridor centering with side walls (optional) ---
    w = (v > 0.0) ? ((laserDistance.dLeftMin < laserDistance.dRightMin - 0.05) ? w - 0.1 : ((laserDistance.dRightMin < laserDistance.dLeftMin - 0.05) ? w + 0.1 : w)) : w;

    if v > 0.0 {
        // if front wall closer than 0.30 m, slow down
        if laserDistance.dFrontMin < 0.30 {
            v = v * 0.5;
        }

        // --- 2) Corridor centering with side walls (optional) ---
        // If left wall significantly closer than right, steer a bit right.
        if laserDistance.dLeftMin < laserDistance.dRightMin - 0.05 {
            w = w - 0.1;
        } else if laserDistance.dRightMin < laserDistance.dLeftMin - 0.05 {
            w = w + 0.1;
        }
    }

    // --- 3) Saturate to hardware limits ---
    v = (v > baseValues.maxSpeed) ? baseValues.maxSpeed : v;
    v = (v < -baseValues.maxSpeed) ? -baseValues.maxSpeed : v;
    w = (w > baseValues.maxRotation) ? baseValues.maxRotation : w;
    w = (w < -baseValues.maxRotation) ? -baseValues.maxRotation : w;

    // --- 4) Finally, send to the TurtleBot ---
    output.speed    = v;
    output.rotation = w;